language: python
matrix:
  include:
  - name: Code quality tests
    env: TOXENV=black,flake8,mypy,docs
    python: 3.7
    dist: xenial
    sudo: true
  - name: Unit tests with Python 3.7
    env: TOXENV=py37
    python: 3.7
    dist: xenial
    sudo: true
  - name: Unit tests with Python 3.6
    env: TOXENV=py36
    python: 3.6
cache:
  directories:
  - "$HOME/.cache/pip"
  - "$TRAVIS_BUILD_DIR/.tox"
install:
- pip install "poetry>=0.12.16"
- poetry install
script:
- tox -e $TOXENV -- --cov-report term-missing --cov=src
after_success:
- codecov
deploy:
  provider: pypi
  distributions: sdist bdist_wheel
  on:
    branch: master
    tags: true
    python: 3.7
  skip_existing: true
  user: mvanlonden
  password:
    secure: Pn76qa8IKoAtWtmc8N6mNyHNibSuMC8W+2pwlrwMIr1BhJaav+IZjs8oTZrFHDpLPS4+vKs21S3uNNfwabdV85L+qbOwxlVkgZ1IN0gGM1HA9SMmPQAt+Gsy5EUwaYwEGdej3+Vz1P10rtDIXpNBAB8DrwHzMSjGWBrJgnGqpAUaocVLfKqlB8Vt/4N+7B0B8LTP1LCuk7QOGbsor5yXzzUTlonl7BKn7JTZKMunqEv901/0KKr/za9xc4X+O+VBL6a7UXjXaxPyt6otrxeOcLEVuf/t/ZLGzQ5H5h7sccaWRFxogJIhR4h4LZOXF4gK+1tI+OJREEv4+ch3HOworJl7xqe1DtaobnP96/RUkQynomx5qYawzT/1MOt41kp47A0G72dV124cEzTNpqYvYntbm07ouIFMUvFazzEeclOeAA+BNaCKgACFZJIGgr16ldv7d/TK1Udmh9n0Pz/q503EwoVRyxSZ+eo+yoC+JkOZfrm2yQ2cERHc6lk8KT6SiuP3zkf/0lYCneXvx1B5807JxaGGklVUx3yM6Ccao/QG9slroKch6gs1h+ZPS3HQxrGJQf2t8NFUjhrdTD5hO0wdA+NzbN/feKaqAPiMLRFCiqMZBffo0oamRTG4ceoIMnMG/EDkg3LTbRKwKGWU0VR1+gPhp9Gbqvlsh4Dycx0=
